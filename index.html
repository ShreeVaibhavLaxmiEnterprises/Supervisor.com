<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shree Vaibhav Laxmi Enterprises</title>

<style>
:root{
--primary:#d32f2f;
--secondary:#1976d2;
--bg:#f4f7f6;
--text:#333;
}
body{font-family:Segoe UI,Arial;background:var(--bg);margin:0;padding:10px}
.container{max-width:900px;margin:auto;background:#fff;padding:20px;border-radius:8px}
header{text-align:center;border-bottom:2px solid #000;padding-bottom:10px}
header img{max-height:70px;display:block;margin:auto}
h1{margin:5px 0;color:var(--primary)}
.sub-header{font-weight:bold;font-size:.9rem}

button{padding:10px;border:0;border-radius:5px;margin-top:8px;color:#fff;cursor:pointer}
.btn-blue{background:#1976d2}
.btn-green{background:#2e7d32}
.btn-purple{background:#7b1fa2}
.btn-red{background:#c62828}

.form-section{border:1px solid #ddd;padding:15px;margin-top:15px;border-radius:6px}
.section-title{background:#eee;padding:8px;font-weight:bold;border-left:5px solid var(--secondary)}

input,select,textarea{width:100%;padding:8px;margin-top:5px}

table{width:100%;border-collapse:collapse;margin-top:10px;font-size:.85rem}
th,td{border:1px solid #ccc;padding:6px;vertical-align:top}
th{background:#eceff1}

.work-img{width:120px;border:1px solid #aaa;margin-top:5px}

.bill-box{border:2px solid #000;padding:15px}
.bill-total{font-size:1.3rem;font-weight:bold;border-top:2px dashed #000;margin-top:10px;padding-top:5px}

.print-daily .hide-daily,
.print-bill .hide-bill,
.print-records .hide-records {display:none}

@media print{
.no-print{display:none!important}
body{background:#fff}
.container{box-shadow:none}
}
</style>
</head>

<body>
<div class="container">

<header>
<img id="logoImg">
<input type="file" class="no-print" onchange="uploadLogo(this)">
<h1>Shree Vaibhav Laxmi Enterprises</h1>
<div class="sub-header">Supervisor : Siddharth Yadav</div>
</header>

<!-- DAILY ENTRY -->
<div class="form-section no-print">
<div class="section-title">Daily Entry</div>
<input type="date" id="entryDate">
<input id="siteName" placeholder="Site Name">
<textarea id="workDesc" placeholder="Work Description"></textarea>
<label>Material Aaya (IN)</label>
<textarea id="matIn"></textarea>
<label>Material Laga (OUT)</label>
<textarea id="matOut"></textarea>
<input type="file" id="sitePhoto" accept="image/*">
<button class="btn-green" onclick="saveDaily()">Save Daily Entry</button>
<button class="btn-blue" onclick="printDaily()">Daily Entry PDF</button>
</div>

<!-- HISAB KITAB -->
<div class="form-section no-print">
<div class="section-title">Hisab Kitab</div>
<input id="billWorker" placeholder="Worker Name">
<input type="date" id="fromDate">
<input type="date" id="toDate">
<input type="number" id="billAmount" placeholder="Total Amount ₹">
<button class="btn-purple" onclick="generateBill()">Bill PDF</button>
</div>

<!-- BILL -->
<div id="billArea" class="hide-bill">
<div class="bill-box">
<h2 style="text-align:center">PAYMENT BILL</h2>
<p><b>Bill No:</b> <span id="billNo"></span></p>
<p><b>Worker:</b> <span id="bName"></span></p>
<p><b>Date:</b> <span id="bDate"></span></p>
<div class="bill-total">TOTAL ₹ <span id="bAmt"></span></div>
</div>
</div>

<!-- SAVED RECORDS -->
<div class="form-section no-print">
<div class="section-title">Saved Records</div>
<button class="btn-blue" onclick="printRecords()">Full Register PDF</button>
</div>

<table id="recordsTable" class="hide-records">
<thead>
<tr>
<th>Date</th><th>Site</th><th>Work</th><th>Material</th>
</tr>
</thead>
<tbody id="records"></tbody>
</table>

</div>

<script>
entryDate.valueAsDate=new Date();

function uploadLogo(inp){
let r=new FileReader();
r.onload=()=>{localStorage.setItem("logo",r.result);logoImg.src=r.result}
r.readAsDataURL(inp.files[0]);
}
logoImg.src=localStorage.getItem("logo")||"";

function saveDaily(){
let r=JSON.parse(localStorage.getItem("records"))||[];
let img="";
if(sitePhoto.files[0]){
let rd=new FileReader();
rd.onload=()=>{img=rd.result;push()}
rd.readAsDataURL(sitePhoto.files[0]);
}else push();

function push(){
r.push({
d:entryDate.value,
s:siteName.value,
w:workDesc.value,
inm:matIn.value,
outm:matOut.value,
img
});
localStorage.setItem("records",JSON.stringify(r));
alert("Saved");
}
}

function loadRecords(){
let r=JSON.parse(localStorage.getItem("records"))||[];
records.innerHTML=r.map(x=>`
<tr>
<td>${x.d}</td>
<td>${x.s}</td>
<td>${x.w}<br>${x.img?`<img class="work-img" src="${x.img}">`:""}</td>
<td>${x.inm}<br>${x.outm}</td>
</tr>`).join("");
}
loadRecords();

function printDaily(){
document.body.className="print-daily";
window.print();
document.body.className="";
}

function generateBill(){
let n=parseInt(localStorage.getItem("billNo")||1000)+1;
localStorage.setItem("billNo",n);
billNo.innerText=n;
bName.innerText=billWorker.value;
bDate.innerText=(fromDate.value||"")+" - "+(toDate.value||"");
bAmt.innerText=billAmount.value;
document.body.className="print-bill";
window.print();
document.body.className="";
}

function printRecords(){
loadRecords();
document.body.className="print-records";
window.print();
document.body.className="";
}
</script>

</body>
</html>
