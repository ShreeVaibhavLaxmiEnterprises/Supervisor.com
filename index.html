<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Shree Vaibhav Laxmi Enterprises</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
body{font-family:Arial;background:#f4f6f8}
.container{max-width:980px;margin:15px auto;background:#fff;padding:20px}
h1{text-align:center;color:#b71c1c;margin:5px}
h3{text-align:center;color:#555;margin-top:0}
.section{background:#eee;padding:8px;margin-top:15px;font-weight:bold}
input,select,textarea{width:100%;padding:7px;margin-top:5px}
.btn{padding:10px;border:none;color:#fff;border-radius:5px;cursor:pointer;margin-top:8px}
.blue{background:#1976d2}.green{background:#2e7d32}
.purple{background:#7b1fa2}.print{background:#0288d1}
.workers div{display:flex;justify-content:space-between;background:#e3f2fd;padding:6px;margin-top:5px}
.workers input{width:60px}
img{max-width:120px;border:1px solid #ccc;margin-top:5px}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #ccc;padding:6px;text-align:center}
#addBox{display:none;border:1px solid #ccc;padding:10px;margin-top:10px}
.bill{padding:20px}
.bill h2{text-align:center;margin:0}
.bill hr{margin:10px 0}
</style>
</head>

<body>

<div class="container">

<h1>SHREE VAIBHAV LAXMI ENTERPRISES</h1>
<h3>Supervisor: Siddharth Yadav | Tracking App</h3>

<button class="btn blue" onclick="toggleAdd()">+ Worker Add Karein</button>

<div id="addBox">
<input id="wName" placeholder="Worker Name">
<input id="wRate" placeholder="Daily Rate">
<select id="wType">
<option>Mistri</option>
<option>Helper</option>
<option>Other</option>
</select>
<button class="btn green" onclick="addWorker()">Add Worker</button>
</div>

<div class="section">Daily Entry (रोज़ का काम)</div>

Date:
<input type="date" id="date">

Site Name:
<input id="site">

<div class="section">Worker Hajari</div>
<div class="workers" id="workerList"></div>
<small>*1 = Full Day | 0.5 = Half Day</small>

Maal Aaya:
<textarea id="inMat"></textarea>

Maal Laga:
<textarea id="outMat"></textarea>

Aaj ka Kaam:
<textarea id="work"></textarea>

Image:
<input type="file" onchange="preview(event)">
<img id="imgPrev">

<button class="btn green" onclick="saveDaily()">Save Daily Record</button>
<button class="btn print" onclick="dailyPDF()">Daily Entry PDF</button>

<div class="section">Hisab Kitab</div>

From:
<input type="date" id="from">
To:
<input type="date" id="to">

Select Worker:
<select id="workerSelect"></select>

<button class="btn purple" onclick="calc()">Check Hisab</button>
<button class="btn print" onclick="workerBill()">Worker Dehari Raseed PDF</button>

<div id="result"></div>

<table id="table">
<tr>
<th>Date</th><th>Worker</th><th>Days</th><th>Amount</th><th>Image</th>
</tr>
</table>

</div>

<!-- BILL AREA -->
<div id="billArea" style="display:none">
<div class="bill">
<h2>SHREE VAIBHAV LAXMI ENTERPRISES</h2>
<p style="text-align:center">Worker Dehari Raseed</p>
<hr>
<div id="billData"></div>
<hr>
<p>Signature: ____________</p>
</div>
</div>

<script>
let workers=[],records=[],imgData="";

function toggleAdd(){
 addBox.style.display=addBox.style.display=="none"?"block":"none";
}

function addWorker(){
 let w={name:wName.value,rate:+wRate.value,type:wType.value};
 workers.push(w);
 wName.value=wRate.value="";
 renderWorkers();
 renderSelect();
}

function renderWorkers(){
 workerList.innerHTML="";
 workers.forEach((w,i)=>{
  workerList.innerHTML+=`
  <div>${w.name} (${w.type}) ₹${w.rate}
  <input type="number" step="0.5" id="att${i}" value="0"></div>`;
 });
}

function renderSelect(){
 workerSelect.innerHTML="<option value=''>All</option>";
 workers.forEach((w,i)=>{
  workerSelect.innerHTML+=`<option value="${i}">${w.name}</option>`;
 });
}

function preview(e){
 let r=new FileReader();
 r.onload=()=>{imgData=r.result;imgPrev.src=imgData;}
 r.readAsDataURL(e.target.files[0]);
}

function saveDaily(){
 workers.forEach((w,i)=>{
  let d=+document.getElementById("att"+i).value;
  if(d>0){
   records.push({
    date:date.value,worker:i,days:d,
    amt:d*w.rate,img:imgData
   });
  }
 });
 alert("Saved");
}

function dailyPDF(){
 html2pdf().from(document.querySelector(".container"))
 .set({filename:"Daily_Entry.pdf"}).save();
}

function calc(){
 let f=from.value,t=to.value,wi=workerSelect.value;
 let sum=0;
 table.innerHTML=`<tr><th>Date</th><th>Worker</th><th>Days</th><th>Amount</th><th>Image</th></tr>`;
 records.forEach(r=>{
  if((!wi||r.worker==wi)&&(!f||r.date>=f)&&(!t||r.date<=t)){
   sum+=r.amt;
   table.innerHTML+=`
   <tr>
   <td>${r.date}</td>
   <td>${workers[r.worker].name}</td>
   <td>${r.days}</td>
   <td>₹${r.amt}</td>
   <td>${r.img?`<img src="${r.img}" width="60">`:""}</td>
   </tr>`;
  }
 });
 result.innerHTML="<b>Total: ₹"+sum+"</b>";
}

function workerBill(){
 let wi=workerSelect.value;
 if(wi==="") return alert("Select Worker");
 let total=0,days=0;
 records.forEach(r=>{
  if(r.worker==wi){total+=r.amt;days+=r.days;}
 });
 billData.innerHTML=`
 Worker Name: <b>${workers[wi].name}</b><br>
 Type: ${workers[wi].type}<br>
 Total Days: ${days}<br>
 Total Amount: ₹${total}
 `;
 html2pdf().from(billArea)
 .set({filename:"Worker_Dehari_Raseed.pdf"}).save();
}
</script>

</body>
</html>
