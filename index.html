<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Shree Vaibhav Laxmi Enterprises</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
body{font-family:Arial;background:#f4f6f8;margin:0}
.container{max-width:950px;margin:15px auto;background:#fff;padding:20px;border-radius:6px}
h1{text-align:center;color:#c62828;margin:5px}
h3{text-align:center;color:#555;margin-top:0;font-weight:normal}
.btn{padding:10px;border:none;color:#fff;border-radius:5px;cursor:pointer}
.blue{background:#1976d2} .green{background:#2e7d32}
.purple{background:#7b1fa2} .print{background:#0288d1;float:right}
.section{background:#eee;padding:8px;margin-top:15px;font-weight:bold}
input,select,textarea{width:100%;padding:7px;margin-top:5px}
.workers div{display:flex;justify-content:space-between;background:#e3f2fd;padding:6px;margin-top:5px}
.workers input{width:60px}
img.preview{max-width:150px;margin-top:8px;border:1px solid #ccc}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #ccc;padding:6px;text-align:center}
#workerBox{display:none;background:#fff;padding:10px;border:1px solid #ccc;margin-top:10px}
</style>
</head>

<body>
<div class="container" id="pdfArea">

<h1>SHREE VAIBHAV LAXMI ENTERPRISES</h1>
<h3>Supervisor: Siddharth Yadav | Tracking App</h3>

<button class="btn blue" onclick="toggleWorkerBox()">+ Worker Add Karein (Manage List)</button>

<div id="workerBox">
<input id="wName" placeholder="Worker Name">
<input id="wRate" placeholder="Daily Rate">
<button class="btn green" onclick="addWorker()">Add Worker</button>
</div>

<div class="section">Daily Entry (रोज़ का काम)</div>

Date:
<input type="date" id="date">

Site Name:
<input id="site" placeholder="Gupta Ji House">

<div class="section">Worker Hajari</div>
<div class="workers" id="workerList"></div>
<small></textarea></small>

Maal Aaya (IN):
<textarea id="inMat"></textarea>

Maal Laga (OUT):
<textarea id="outMat"></textarea>

Aaj ka Kaam:
<textarea id="work"></textarea>

Image Upload:
<input type="file" onchange="previewImg(event)">
<img id="imgPrev" class="preview">

<button class="btn green" onclick="saveRecord()">Save Daily Record</button>

<div class="section">Hisab Kitab (Calculator)</div>

From:
<input type="date" id="from">
To:
<input type="date" id="to">

<button class="btn purple" onclick="calcHisab()">Check Hisab</button>

<div id="hisabResult"></div>

<div class="section">
Saved Records / PDF Register
<button class="btn print" onclick="makePDF()">Print / Save PDF</button>
</div>

<table id="table">
<tr>
<th>Date/Site</th>
<th>Work & Material</th>
<th>Payment</th>
<th>Image</th>
</tr>
</table>

</div>

<script>
let workers=[];
let records=[];
let imgData="";

function toggleWorkerBox(){
 document.getElementById("workerBox").style.display=
 document.getElementById("workerBox").style.display=="none"?"block":"none";
}

function addWorker(){
 let n=wName.value,r=wRate.value;
 if(!n||!r) return alert("Fill worker details");
 workers.push({name:n,rate:r});
 wName.value=wRate.value="";
 renderWorkers();
}

function renderWorkers(){
 let box=document.getElementById("workerList");
 box.innerHTML="";
 workers.forEach((w,i)=>{
  box.innerHTML+=`
   <div>
    ${w.name} (₹${w.rate})
    <input type="number" step="0.5" id="att${i}" value="0">
   </div>`;
 });
}

function previewImg(e){
 let r=new FileReader();
 r.onload=()=>{imgData=r.result;imgPrev.src=imgData;}
 r.readAsDataURL(e.target.files[0]);
}

function saveRecord(){
 let total=0;
 workers.forEach((w,i)=>{
  total+=w.rate*(document.getElementById("att"+i).value||0);
 });
 records.push({date:date.value,site:site.value,work:work.value,
 inMat:inMat.value,outMat:outMat.value,pay:total,img:imgData});
 drawTable();
 alert("Saved");
}

function drawTable(){
 let t=document.getElementById("table");
 t.innerHTML=`<tr><th>Date/Site</th><th>Work & Material</th><th>Payment</th><th>Image</th></tr>`;
 records.forEach(r=>{
 t.innerHTML+=`
 <tr>
  <td>${r.date}<br>${r.site}</td>
  <td>${r.work}<br><small>${r.inMat} / ${r.outMat}</small></td>
  <td>₹${r.pay}</td>
  <td>${r.img?`<img src="${r.img}" width="80">`:""}</td>
 </tr>`;
 });
}

function calcHisab(){
 let sum=records.reduce((a,b)=>a+b.pay,0);
 hisabResult.innerHTML="<b>Total Amount: ₹"+sum+"</b>";
}

function makePDF(){
 html2pdf().from(document.getElementById("pdfArea"))
 .set({filename:"Billing_Report.pdf"}).save();
}
</script>
</body>
</html>
