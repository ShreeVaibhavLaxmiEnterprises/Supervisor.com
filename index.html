<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Shree Vaibhav Laxmi Enterprises</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<style>
body{font-family:Arial,sans-serif;background:#f4f4f4;margin:0;padding:10px}
h1,h2{text-align:center;margin:5px 0}
.box{background:#fff;padding:15px;margin:10px 0;border-radius:8px;box-shadow:0 0 5px #ccc}
input,select,textarea,button{width:100%;margin:5px 0;padding:8px;border-radius:5px;border:1px solid #ccc}
button{background:#2e86de;color:#fff;border:none;cursor:pointer}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border:1px solid #ccc;padding:6px;text-align:center}
img{max-width:100px}
.del{background:red;color:#fff;border:none;padding:2px 5px;border-radius:3px;cursor:pointer}
</style>
</head>
<body>

<h1 style="font-size:32px">SHREE VAIBHAV LAXMI ENTERPRISES</h1>
<p style="text-align:center;"><b>Supervisor:</b> Siddharth Yadav | Tracking Website</p>

<!-- WORKER ADD -->
<div class="box">
<h2>Worker Add Karein</h2>
<input id="wname" placeholder="Worker Name">
<select id="wtype">
<option>Mistry</option>
<option>Helper</option>
<option>Other</option>
</select>
<input id="wrate" placeholder="Daily Rate ₹">
<button onclick="addWorker()">Add Worker</button>

<table id="workerTable">
<tr><th>Name</th><th>Type</th><th>Rate</th><th>Del</th></tr>
</table>
</div>

<!-- DAILY ENTRY -->
<div class="box">
<h2>Daily Entry (रोज़ का काम)</h2>
<input type="date" id="date">
<input placeholder="Site Name" id="site">
<select id="workerSelect"></select>
<select id="hajri">
<option value="1">Full Day (1)</option>
<option value="0.5">Half Day (0.5)</option>
</select>
<input placeholder="Maal Aaya (IN)" id="in">
<input placeholder="Maal Laga (OUT)" id="out">
<textarea placeholder="Aaj ka Kaam" id="work"></textarea>
<input type="file" id="img">
<button onclick="saveDaily()">Save Daily Record</button>
<button onclick="generateDailyPDF()">Generate Daily PDF</button>
</div>

<!-- SAVED RECORDS -->
<div class="box">
<h2>Saved Records</h2>
<table id="recordTable">
<tr>
<th>Date/Site</th>
<th>Work & Material</th>
<th>Payment</th>
<th>Image</th>
<th>Del</th>
</tr>
</table>
</div>

<script>
let workers=JSON.parse(localStorage.getItem("workers")||"[]");
let records=JSON.parse(localStorage.getItem("records")||"[]");

function saveLocal(){
localStorage.setItem("workers",JSON.stringify(workers));
localStorage.setItem("records",JSON.stringify(records));
}

// Load Worker & Records
function load(){
workerTable.innerHTML="<tr><th>Name</th><th>Type</th><th>Rate</th><th>Del</th></tr>";
workerSelect.innerHTML="";

workers.forEach((w,i)=>{
workerTable.innerHTML+=`<tr>
<td>${w.name}</td><td>${w.type}</td><td>₹${w.rate}</td>
<td><button class="del" onclick="delWorker(${i})">X</button></td></tr>`;
workerSelect.innerHTML+=`<option value="${i}">${w.name}</option>`;
});

recordTable.innerHTML=`<tr>
<th>Date/Site</th><th>Work & Material</th><th>Payment</th><th>Image</th><th>Del</th></tr>`;
records.forEach((r,i)=>{
recordTable.innerHTML+=`<tr>
<td>${r.date}<br>${r.site}</td>
<td>${r.work}<br>IN:${r.inn} OUT:${r.out}</td>
<td>₹${r.pay}</td>
<td>${r.img?`<img src="${r.img}">`:""}</td>
<td><button class="del" onclick="delRec(${i})">X</button></td>
</tr>`;
});
}

// Worker Add/Remove
function addWorker(){
let name=document.getElementById("wname").value;
let type=document.getElementById("wtype").value;
let rate=parseFloat(document.getElementById("wrate").value);
if(!name||!rate){alert("Name & Rate required");return;}
workers.push({name,type,rate});
saveLocal(); load();
document.getElementById("wname").value="";
document.getElementById("wrate").value="";
}

function delWorker(i){workers.splice(i,1); saveLocal(); load();}
function delRec(i){records.splice(i,1); saveLocal(); load();}

// Save Daily Entry
function saveDaily(){
let w=workers[workerSelect.value];
let pay=w.rate*parseFloat(document.getElementById("hajri").value);
let reader=new FileReader();
reader.onload=()=>{
records.push({
date:document.getElementById("date").value,
site:document.getElementById("site").value,
work:document.getElementById("work").value,
inn:document.getElementById("in").value,
out:document.getElementById("out").value,
worker:w.name,pay:pay,img:reader.result
});
saveLocal(); load();
}
if(document.getElementById("img").files[0]) reader.readAsDataURL(document.getElementById("img").files[0]);
else reader.onload();
}

// Generate Daily PDF
function generateDailyPDF(){
const {jsPDF}=window.jspdf;
let pdf=new jsPDF();
records.forEach(r=>{
pdf.setFontSize(18);pdf.text("SHREE VAIBHAV LAXMI ENTERPRISES",10,15);
pdf.setFontSize(12);pdf.text(`Supervisor: Siddharth Yadav`,10,25);
pdf.setFontSize(14);pdf.text(`Date: ${r.date}`,10,35);
pdf.text(`Site: ${r.site}`,10,42);
pdf.text(`Worker: ${r.worker}`,10,49);
pdf.text(`Attendance: ${r.pay/records.find(w=>w.worker==r.worker).pay?1:0.5}`,10,56);
pdf.text(`Work: ${r.work}`,10,63);
pdf.text(`IN: ${r.inn} OUT: ${r.out}`,10,70);
pdf.text(`Payment: ₹${r.pay}`,10,77);
if(r.img) pdf.addImage(r.img,'JPEG',10,85,50,50);
pdf.addPage();
});
pdf.save("Daily_Record.pdf");
}

load();
</script>
</body>
</html>
